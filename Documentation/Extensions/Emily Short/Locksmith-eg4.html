<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Extension</title></head><STYLE TYPE="text/css"><!--.oval, .oval TD{background-image:url('inform:/doc_images/ovoid.png');color:white;}--></STYLE><body><script language="JavaScript">function pasteCode(code) {    var myProject = external.Project;    myProject.selectView('source');    myProject.pasteCode(code);}</script><font size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"><a href="inform://Extensions/Extensions.html" border=0><img border=0 src="inform:/doc_images/Hookindex.png" border=0></a></td><TD width=38px height=26px align="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><font color="#FFFFFF" size=2>Extensions</font></a></td><TD width=56px height=26px align="right" valign="center"><a href="inform:/index.html" border=0><img border=0 src="inform:/doc_images/Hookup.png" border=0></a></td></tr></table><p><script language="JavaScript">
function pasteCode2512(code) {
    var myProject = external.Project;

    myProject.selectView('source');
    myProject.pasteCode('Include Locksmith by Emily Short.[=0x000A=][=0x000A=][=0x000A=]');
}
</script>
<a href="javascript:pasteCode2512()"><img border=0 src=inform:/doc_images/paste.png></a>&nbsp;<b>Locksmith<font color="#404040"> by </font>Emily Short</b><p><small><p>Version 11 built in to Inform</small><p>Implicit handling of doors and containers so that lock manipulation is automatic if the player has the necessary keys.<p>Kinds: <b>passkey</b> (a kind of thing), <b>keychain</b> (a kind of supporter)<p>Actions: <b>Unlocking keylessly</b>, <b>Locking keylessly</b>, <b>Universal unlocking</b><p>Verbs: to <b>unbolt</b><p>Adjectives: <b>key-accessible</b>, <b>identified</b><p>Use options: <b>sequential action</b><p><p><hr><p>
<p>
 Locksmith adds implicit handling of doors and containers so that lock manipulation is automatic if the player has the necessary keys. There are five parts of Locksmith.
<p>
 First, Locksmith will try opening all doors the player tries to pass through; try closing all lockables before locking them; and try unlocking all locked items before opening them. Other characters will follow the same rules.
<p>
 By default, these actions are described as other automatic actions usually are in Inform: the player sees something like &quot;(first unlocking...)&quot; before he opens the door. The &quot;Use sequential action&quot; mode is provided for the case where we would prefer to see &quot;You unlock the door.&quot; instead.
<p>
 If the player tries to open a door but does not have the right key, he receives a key-refusal message, such as &quot;You lack a key that fits the red chest.&quot; We can override this by writing other &quot;to say key-refusal for...&quot; phrases, like this:
<p>
<blockquote><font color="#000080"> To say key-refusal for (locked-thing - a container):<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You will be unable to see the contents of [the locked-thing] until you find the appropriate key.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> To say key-refusal for (locked-thing - the red chest):<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;The red chest resists all your attempts because you do not have the magic orb.&quot;</font></blockquote>
<p>
 Second, Locksmith tries to provide an intelligent default if no key is specified, so that &gt;LOCK DOOR will work if the player is holding the correct key.
<p>
 Third, Locksmith introduces a kind called the passkey. The passkey is a key which will name itself in inventory listings after use. Once the passkey has been identified, the game also automates taking the key before using it on the door it matches. Keys the player has never successfully identified, or keys not defined as belonging to the passkey kind, will not behave this way. Passkeys are also renamed if the player has seen another character use them successfully.
<p>
 The &quot;unbolts&quot; relation is used to keep track of what the player knows about keys. We will probably not need to do this in most cases, but it is possible to change this manually during play to give the player new knowledge (or ignorance) about the functions of keys.
<p>
 Passkeys can also be used with the keychain kind. Keychains are portable supporters which can have passkeys (but only passkeys) put on them. Keys on a keychain can be used as though they were in the player's hand, and will not be automatically removed for locking and unlocking actions.
<p>
 Finally, Locksmith provides the debugging command 'unlockall', only identified in debugging compilations of the game. If during play we type UNLOCKALL, all locks in the game will magically spring open.
<p>
<hr><p><a name=eg1><table border="0" cellspacing="0" cellpadding="0"><tr><td halign="left" valign="top" cellpadding=0 cellspacing=0 width=38px><table border="0" cellspacing="0" cellpadding="0"><tr class="oval"><td width=38px height=30px align="left" valign="center"><a href="Locksmith-eg1.html#eg1" STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>A</b></div></a></td></tr></table></td><td cellpadding=0 cellspacing=0 halign="left" valign="top"><font size=2><a href="Locksmith-eg1.html#eg1" STYLE="text-decoration: none"><img border="0" src='inform:/doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000">Latches</font></b></a><br>Adding one lock in the game that is managed by latch rather than by a key.<p></td></tr></table><p>
<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>
<hr><p><a name=eg2><table border="0" cellspacing="0" cellpadding="0"><tr><td halign="left" valign="top" cellpadding=0 cellspacing=0 width=38px><table border="0" cellspacing="0" cellpadding="0"><tr class="oval"><td width=38px height=30px align="left" valign="center"><a href="Locksmith-eg2.html#eg2" STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>B</b></div></a></td></tr></table></td><td cellpadding=0 cellspacing=0 halign="left" valign="top"><font size=2><a href="Locksmith-eg2.html#eg2" STYLE="text-decoration: none"><img border="0" src='inform:/doc_images/asterisk.png'><img border="0" src='inform:/doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000">Tobacco</font></b></a><br>Passkeys that open more than one thing each.<p></td></tr></table><p>
<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>
<hr><p><a name=eg3><table border="0" cellspacing="0" cellpadding="0"><tr><td halign="left" valign="top" cellpadding=0 cellspacing=0 width=38px><table border="0" cellspacing="0" cellpadding="0"><tr class="oval"><td width=38px height=30px align="left" valign="center"><a href="Locksmith-eg3.html#eg3" STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>C</b></div></a></td></tr></table></td><td cellpadding=0 cellspacing=0 halign="left" valign="top"><font size=2><a href="Locksmith-eg3.html#eg3" STYLE="text-decoration: none"><img border="0" src='inform:/doc_images/asterisk.png'><img border="0" src='inform:/doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000">Rekeying</font></b></a><br>Modifying the way passkey descriptions work.<p></td></tr></table><p>
<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>

<p>
<hr><p><a name=eg4><table border="0" cellspacing="0" cellpadding="0"><tr><td halign="left" valign="top" cellpadding=0 cellspacing=0 width=38px><table border="0" cellspacing="0" cellpadding="0"><tr class="oval"><td width=38px height=30px align="left" valign="center"><a href="Locksmith.html#eg4" STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>D</b></div></a></td></tr></table></td><td cellpadding=0 cellspacing=0 halign="left" valign="top"><font size=2><a href="Locksmith.html#eg4" STYLE="text-decoration: none"><img border="0" src='inform:/doc_images/asterisk.png'><img border="0" src='inform:/doc_images/asterisk.png'><img border="0" src='inform:/doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000">Watchtower</font></b></a><br>Using sequential actions to make the player's activities more equal with those of another character.<p></td></tr></table><p><table border="0" cellspacing="0" cellpadding="0" bgcolor="#f0f0f0" width=100%><tr><td align="left" valign="top"><font size=2><p>
<p>
 Suppose that instead of the &quot;(first unlocking...)&quot; text, we would like to offer some more interesting flavor text. We might accomplish this by sequential action option is active and then supplying new report rules for specific actions. (Notice that we do not make them After... rules, on the grounds that those would stop the action process. We want to report these actions and allow them to succeed normally.)
<p>
<blockquote><font color="#000080"><script language="JavaScript">
function pasteCode2513(code) {
    var myProject = external.Project;

    myProject.selectView('source');
    myProject.pasteCode('[=0x0022=]Watchtower[=0x0022=][=0x000A=][=0x000A=]Use sequential action. Include Locksmith by Emily Short.[=0x000A=][=0x000A=]Bridge is a room. [=0x0022=]Beneath this long, narrow bridge is a gully full of ice-water from the mountains above. It runs milky at this time of year, and is not fit to drink. The air off it is bitterly cold. Just north of here is the Roman watchtower, built square and still defensible despite several centuries of neglect.[=0x0022=][=0x000A=][=0x000A=]North of Bridge is the tower door. The tower door is a lockable locked door. It is scenery. Understand [=0x0022=]watchtower[=0x0022=] as the tower door. The tower door is south of the Watchtower. The large iron key unlocks the tower door. The player carries the large iron key.[=0x000A=][=0x000A=]The description of the Watchtower is [=0x0022=]The wooden floor has mostly rotted away, exposing the square pit in which the paymaster used to keep the soldiers[[=0x0027=]] coin. It is possible to move around the perimeter of the room without falling in, however.[=0x0022=][=0x000A=][=0x000A=]Report unlocking something with something when the player is in Bridge:[=0x000A=][=0x0009=]say [=0x0022=]Shivering and fumbling, you manage to unlock [the noun] with [the second noun]. Your fingers are very nearly numb.[=0x0022=] instead.[=0x000A=][=0x000A=]Report unlocking something with something when the player is in Bridge:[=0x000A=][=0x0009=]say [=0x0022=]Shivering and fumbling, you manage to unlock [the noun] with [the second noun]. Your fingers are very nearly numb.[=0x0022=] instead.[=0x000A=][=0x000A=]Report opening the tower door:[=0x000A=][=0x0009=]say [=0x0022=]The tower door resists your first shove or two, but then falls open.[=0x0022=] instead.[=0x000A=][=0x000A=]Leif is a man in the Bridge.[=0x000A=][=0x000A=]A persuasion rule: persuasion succeeds.[=0x000A=][=0x000A=]Report someone trying unlocking a door with something:[=0x000A=][=0x0009=]say [=0x0022=][The person asked] rattles the handle of [the noun] a few times, then thinks to try [the second noun] on it. [=0x0027=]Bit stiff, this.[=0x0027=][=0x0022=] instead.[=0x000A=][=0x000A=]Report someone trying opening the tower door:[=0x000A=][=0x0009=]say [=0x0022=][The person asked] gives [the tower door] several [if the person asked is in the Bridge]shoves[otherwise]firm tugs[end if] before managing to open it.[=0x0022=] instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]drop key / open door / get key / n / s / lock door / drop key / Leif, get key / Leif, n[=0x0022=].[=0x000A=][=0x000A=]');
}
</script>
<a href="javascript:pasteCode2513()"><img border=0 src=inform:/doc_images/paste.png></a> &quot;Watchtower&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Use sequential action. Include Locksmith by Emily Short.</font></blockquote>
<p>
<blockquote><font color="#000080"> Bridge is a room. &quot;Beneath this long, narrow bridge is a gully full of ice-water from the mountains above. It runs milky at this time of year, and is not fit to drink. The air off it is bitterly cold. Just north of here is the Roman watchtower, built square and still defensible despite several centuries of neglect.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> North of Bridge is the tower door. The tower door is a lockable locked door. It is scenery. Understand &quot;watchtower&quot; as the tower door. The tower door is south of the Watchtower. The large iron key unlocks the tower door. The player carries the large iron key.</font></blockquote>
<p>
<blockquote><font color="#000080"> The description of the Watchtower is &quot;The wooden floor has mostly rotted away, exposing the square pit in which the paymaster used to keep the soldiers['] coin. It is possible to move around the perimeter of the room without falling in, however.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Report unlocking something with something when the player is in Bridge:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;Shivering and fumbling, you manage to unlock [the noun] with [the second noun]. Your fingers are very nearly numb.&quot; instead.</font></blockquote>
<p>
<blockquote><font color="#000080"> Report unlocking something with something when the player is in Bridge:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;Shivering and fumbling, you manage to unlock [the noun] with [the second noun]. Your fingers are very nearly numb.&quot; instead.</font></blockquote>
<p>
<blockquote><font color="#000080"> Report opening the tower door:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;The tower door resists your first shove or two, but then falls open.&quot; instead.</font></blockquote>
<p>
<blockquote><font color="#000080"> Leif is a man in the Bridge.</font></blockquote>
<p>
<blockquote><font color="#000080"> A persuasion rule: persuasion succeeds.</font></blockquote>
<p>
<blockquote><font color="#000080"> Report someone trying unlocking a door with something:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[The person asked] rattles the handle of [the noun] a few times, then thinks to try [the second noun] on it. 'Bit stiff, this.'&quot; instead.</font></blockquote>
<p>
<blockquote><font color="#000080"> Report someone trying opening the tower door:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[The person asked] gives [the tower door] several [if the person asked is in the Bridge]shoves[otherwise]firm tugs[end if] before managing to open it.&quot; instead.</font></blockquote>
<p>
<blockquote><font color="#000080"> Test me with &quot;drop key / open door / get key / n / s / lock door / drop key / Leif, get key / Leif, n&quot;.</font></blockquote>
<p>
 Leif will also follow the rules about unlocking and opening doors, and have a few special reports of his own -- though in fact we could also arrange matters so that he is unable to do so, by including the following:
<p>
<blockquote><font color="#000080"><script language="JavaScript">
function pasteCode2514(code) {
    var myProject = external.Project;

    myProject.selectView('source');
    myProject.pasteCode('The intelligently opening doors rule is not listed in any rulebook.[=0x000A=]The intelligently closing doors rule is not listed in any rulebook.[=0x000A=]The intelligently closing keyless doors rule is not listed in any rulebook.[=0x000A=]The intelligently opening containers rule is not listed in any rulebook.[=0x000A=][=0x000A=]');
}
</script>
<a href="javascript:pasteCode2514()"><img border=0 src=inform:/doc_images/paste.png></a> The intelligently opening doors rule is not listed in any rulebook.<br> The intelligently closing doors rule is not listed in any rulebook.<br> The intelligently closing keyless doors rule is not listed in any rulebook.<br> The intelligently opening containers rule is not listed in any rulebook.</font></blockquote>
<p>
... and now he will be too dim to handle the keys himself.
<p>
</font></td></tr></table><p>
<p>
<p></body></html>